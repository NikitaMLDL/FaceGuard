<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Описание проекта</title>
    <link rel="stylesheet" href="styles.css">
    <script type="text/javascript" async
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>
</head>
<body>
    <header>
        Проект: Система распознавания лиц
    </header>
    
    <section>
        <h2>Описание</h2>
        <p>Этот проект представляет собой систему распознавания лиц с использованием нейронных сетей. 
        Он позволяет добавлять пользователей, проверять их наличие в базе данных и удалять их.</p>
        <p>Система ориентирована на использование в проходных, офисах и других местах, где требуется быстрый и точный контроль доступа.</p>
    </section>
    
    <section>
        <h2>Функциональность</h2>
        <ul>
            <li><strong>Добавление пользователя:</strong> загружает изображение и сохраняет эмбеддинг в базе данных.</li>
            <li><strong>Проверка пользователя:</strong> сверяет загруженное изображение с существующими эмбеддингами.</li>
            <li><strong>Удаление пользователя:</strong> удаляет эмбеддинг пользователя из базы.</li>
        </ul>
    </section>
    
    <section>
        <h2>Используемые технологии</h2>
        <ul>
            <li>Python (FastAPI)</li>
            <li>FAISS для поиска по эмбеддингам</li>
            <li>FaceNet + MTCNN для детекции и обработки лиц</li>
            <li>Streamlit для интерфейса</li>
        </ul>
    </section>
    
    <section>
        <h2>Выбор модели</h2>
        <h3>Использование CNN</h3>
        <p>Сначала в качестве базового решения использовалась сверточная нейронная сеть (CNN). Однако, для ее качественного обучения требовалось большое количество данных.</p>
        <p>Основной принцип работы CNN заключается в применении сверток и подвыборок (pooling), что позволяет выделять важные признаки изображения.</p>
        <p>Формула свертки:</p>
        <p>\[(I * K)(x, y) = \sum_{i=-m}^{m} \sum_{j=-n}^{n} I(x+i, y+j) K(i, j)\]</p>
        <p>Ниже представлены графики потерь и точности обучения CNN:</p>
        <img src="images/accuracy_plot (1).png" alt="Графики accuracy для CNN">
        <img src="images/loss_plot (1).png" alt="Графики loss для CNN">
        <p>Архитектура модели CNN:</p>
        <img src="images/convnet_fig (1).png" alt="Архитектура CNN">
        
        <h3>Переход на FaceNet</h3>
        <p>Поскольку для системы проходной сложно собрать большой датасет, было принято решение использовать FaceNet.</p>
        <p>FaceNet использует триплетную функцию потерь:</p>
        <p>\[L = \sum_{i} \max(0, || f(A_i) - f(P_i) ||^2 - || f(A_i) - f(N_i) ||^2 + \alpha )\]</p>
        <p>Где:</p>
        <ul>
            <li>\(A_i\) — якорное изображение</li>
            <li>\(P_i\) — положительный пример (изображение того же человека)</li>
            <li>\(N_i\) — отрицательный пример (изображение другого человека)</li>
            <li>\(\alpha\) — маржа, обеспечивающая разницу между положительными и отрицательными примерами</li>
        </ul>
        <p>FaceNet позволяет получать эмбеддинги лиц даже по одной фотографии, что делает его идеальным для применения в условиях ограниченных данных.</p>
        <p>При сравнении моделей FaceNet показал более высокую точность на небольшом количестве данных:</p>
        <img src="images/normalized_accuracy_progress_0.5.png" alt="График точности FaceNet при 0.5">
        <img src="images/normalized_accuracy_progress_0.7.png" alt="График точности FaceNet при 0.7">
        <p>Теперь, когда человек смотрит в камеру, его эмбеддинг вычисляется и сравнивается с базой данных для идентификации.</p>
    </section>
</body>
</html>